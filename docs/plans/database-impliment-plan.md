# minidb é–‹ç™ºãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—

## å®Ÿè£…é€²æ—ã‚µãƒãƒªãƒ¼

| Phase | çŠ¶æ…‹ | å‚™è€ƒ |
|-------|------|------|
| Phase 1: ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‚¨ãƒ³ã‚¸ãƒ³ | âœ… å®Œäº† | |
| Phase 2: ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ | âœ… å®Œäº† | Delete ã¯æœªå®Ÿè£… |
| Phase 3: SQLãƒ‘ãƒ¼ã‚µãƒ¼ & REPL | âœ… å®Œäº† | |
| Phase 4: ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ | âœ… å®Œäº† | WAL/Recovery çµ±åˆå®Œäº† |
| Phase 5: ã‚¯ã‚¨ãƒªæœ€é©åŒ– & é«˜åº¦ãªæ©Ÿèƒ½ | âœ… å®Œäº† | |
| Phase 6: ãƒ¬ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ | âœ… å®Œäº† | Raft åŸºæœ¬å®Ÿè£…å®Œäº† |
| Phase 7: åˆ†æ•£ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ | âœ… å®Œäº† | HLC/MVCC/2PC å®Ÿè£…å®Œäº† |
| Phase 8: ã‚·ãƒ£ãƒ¼ãƒ‡ã‚£ãƒ³ã‚° | âœ… å®Œäº† | Range/Router/Rebalancer å®Ÿè£…å®Œäº† |
| Phase 9: åˆ†æ•£ã‚¯ã‚¨ãƒªå®Ÿè¡Œ | ğŸ”œ æ¬¡ã®ãƒ•ã‚§ãƒ¼ã‚º | |

---

## Phase 1: ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‚¨ãƒ³ã‚¸ãƒ³ âœ… å®Œäº†

- [x] page.go - ãƒšãƒ¼ã‚¸æ§‹é€ ä½“
- [x] pager.go - ãƒ•ã‚¡ã‚¤ãƒ« â†” ãƒšãƒ¼ã‚¸ã®èª­ã¿æ›¸ã
- [x] types.go - ã‚«ãƒ©ãƒ å‹å®šç¾©ï¼ˆInt32, Int64, String, Boolï¼‰
- [x] schema.go - ã‚¹ã‚­ãƒ¼ãƒå®šç¾©
- [x] row.go - è¡Œã®ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚º/ãƒ‡ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚º
- [x] page_layout.go - ã‚¹ãƒ­ãƒƒãƒˆé…åˆ—æ–¹å¼ã®ãƒšãƒ¼ã‚¸ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ
- [x] table.go - ãƒ†ãƒ¼ãƒ–ãƒ«æ“ä½œï¼ˆInsert, Scanï¼‰

---

## Phase 2: ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ âœ… å®Œäº†

- [x] btree.go - B+Tree ã®å®Ÿè£…
  - [x] ãƒãƒ¼ãƒ‰æ§‹é€ ï¼ˆãƒªãƒ¼ãƒ•ãƒãƒ¼ãƒ‰ / å†…éƒ¨ãƒãƒ¼ãƒ‰ï¼‰
  - [x] æ¤œç´¢ï¼ˆSearchï¼‰- äºŒåˆ†æ¢ç´¢ã§ O(log n)
  - [x] æŒ¿å…¥ï¼ˆInsertï¼‰
  - [x] ãƒãƒ¼ãƒ‰åˆ†å‰²ï¼ˆSplitï¼‰
  - [ ] å‰Šé™¤ï¼ˆDeleteï¼‰â€»å¾Œå›ã—
- [x] index.go - ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ç®¡ç†
  - [x] ãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹
  - [x] ãƒ¦ãƒ‹ãƒ¼ã‚¯ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹
  - [x] ã‚»ã‚«ãƒ³ãƒ€ãƒªã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹

**é”æˆ**: `table.Find(id)` ãŒ O(log n) ã§å‹•ã

---

## Phase 3: SQLãƒ‘ãƒ¼ã‚µãƒ¼ & REPL âœ… å®Œäº†

- [x] lexer.go - ãƒˆãƒ¼ã‚¯ãƒ³åˆ†å‰²ï¼ˆå­—å¥è§£æï¼‰
- [x] token.go - ãƒˆãƒ¼ã‚¯ãƒ³å®šç¾©
- [x] ast.go - æŠ½è±¡æ§‹æ–‡æœ¨ï¼ˆASTï¼‰
- [x] parser.go - æ§‹æ–‡è§£æ
  - [x] SELECTæ–‡
  - [x] INSERTæ–‡
  - [x] CREATE TABLEæ–‡
  - [x] DELETEæ–‡
  - [x] UPDATEæ–‡
  - [x] WHEREå¥
  - [x] JOINå¥
  - [x] GROUP BYå¥
- [x] repl.go - å¯¾è©±ã‚·ã‚§ãƒ«ï¼ˆRead-Eval-Print Loopï¼‰
- [x] session.go - ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†
- [x] catalog.go - ã‚«ã‚¿ãƒ­ã‚°ç®¡ç†

**é”æˆ**: `SELECT * FROM users WHERE id = 1` ãŒå‹•ã

---

## Phase 4: ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ âœ… å®Œäº†

- [x] wal.go - Write-Ahead Log
  - [x] ãƒ­ã‚°ãƒ¬ã‚³ãƒ¼ãƒ‰æ§‹é€ ï¼ˆLSN, TxnID, LogType, Before/Afterï¼‰
  - [x] ãƒ­ã‚°æ›¸ãè¾¼ã¿ï¼ˆAppend, Flushï¼‰
  - [x] ãƒ­ã‚°èª­ã¿è¾¼ã¿ï¼ˆReadï¼‰
  - [x] ãƒã‚§ãƒƒã‚¯ãƒã‚¤ãƒ³ãƒˆï¼ˆCheckpointï¼‰
- [x] transaction.go - ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ç®¡ç†
  - [x] BEGIN / COMMIT / ROLLBACK
  - [x] å®Ÿéš›ã®ãƒ†ãƒ¼ãƒ–ãƒ«æ“ä½œã¨ã®çµ±åˆ
- [x] recovery.go - ã‚¯ãƒ©ãƒƒã‚·ãƒ¥ãƒªã‚«ãƒãƒª
  - [x] REDOå‡¦ç†ï¼ˆINSERT/UPDATE/DELETEï¼‰
  - [x] UNDOå‡¦ç†ï¼ˆINSERT/UPDATE/DELETEï¼‰
  - [x] å®Ÿéš›ã®ãƒ†ãƒ¼ãƒ–ãƒ«æ“ä½œã¨ã®çµ±åˆ

**é”æˆ**: INSERT/UPDATE/DELETE ãŒ WAL ã«è¨˜éŒ²ã•ã‚Œã€ã‚¯ãƒ©ãƒƒã‚·ãƒ¥ãƒªã‚«ãƒãƒªãŒå‹•ã

---

## Phase 5: ã‚¯ã‚¨ãƒªæœ€é©åŒ– & é«˜åº¦ãªæ©Ÿèƒ½ âœ… å®Œäº†

- [x] planner.go - å®Ÿè¡Œè¨ˆç”»ä½œæˆ
  - [x] PlanNode ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
  - [x] ScanNode, FilterNode, ProjectNode
  - [x] JoinNode, AggregateNode
  - [x] InsertNode, UpdateNode, DeleteNode
  - [x] CreateTableNode, EmptyNode
- [x] optimizer.go - ã‚¯ã‚¨ãƒªæœ€é©åŒ–
  - [x] Rule ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
  - [x] å†å¸°çš„ãªå­ãƒãƒ¼ãƒ‰æœ€é©åŒ–
- [x] rule.go - æœ€é©åŒ–ãƒ«ãƒ¼ãƒ«
  - [x] FilterPushDownRule - ãƒ•ã‚£ãƒ«ã‚¿æŠ¼ã—ä¸‹ã’
  - [x] ConstantFoldingRule - å®šæ•°ç•³ã¿è¾¼ã¿
- [x] cost.go - ã‚³ã‚¹ãƒˆãƒ¢ãƒ‡ãƒ«
  - [x] Cost ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
  - [x] è¡Œæ•°ãƒ™ãƒ¼ã‚¹ã®ã‚³ã‚¹ãƒˆè¨ˆç®—
- [x] cost_estimator.go - ã‚³ã‚¹ãƒˆæ¨å®š
  - [x] å„ PlanNode ã®ã‚³ã‚¹ãƒˆæ¨å®š
- [x] executor.go - ã‚¯ã‚¨ãƒªå®Ÿè¡Œã‚¨ãƒ³ã‚¸ãƒ³
  - [x] Iterator ãƒ‘ã‚¿ãƒ¼ãƒ³
  - [x] å„ãƒãƒ¼ãƒ‰ã®å®Ÿè¡Œ
- [x] aggregate.go - é›†ç´„é–¢æ•°
  - [x] COUNT, SUM, AVG, MAX, MIN

**é”æˆ**: è¤‡æ•°ãƒ†ãƒ¼ãƒ–ãƒ«ã® JOIN ãŒå‹•ã

---

## Phase 6: ãƒ¬ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆè¤‡è£½ï¼‰âœ… å®Œäº†

- [x] raft/state.go - ãƒãƒ¼ãƒ‰çŠ¶æ…‹ï¼ˆLeader/Follower/Candidateï¼‰
- [x] raft/log.go - Raftãƒ­ã‚°ç®¡ç†
- [x] raft/election.go - ãƒªãƒ¼ãƒ€ãƒ¼é¸æŒ™ï¼ˆRequestVote RPCï¼‰
- [x] raft/replication.go - ãƒ­ã‚°è¤‡è£½ï¼ˆAppendEntries RPCï¼‰
- [x] raft/heartbeat.go - ãƒãƒ¼ãƒˆãƒ“ãƒ¼ãƒˆ
- [x] replication/manager.go - ãƒ¬ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ç®¡ç†
  - [x] ã‚¿ã‚¤ãƒãƒ¼ç®¡ç†ï¼ˆé¸æŒ™ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã€ãƒãƒ¼ãƒˆãƒ“ãƒ¼ãƒˆé–“éš”ï¼‰
  - [x] Transport ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å®šç¾©

**é”æˆ**: Raft ã‚³ãƒ³ã‚»ãƒ³ã‚µã‚¹ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®åŸºæœ¬ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå®Ÿè£…å®Œäº†

**æ®‹ã‚¿ã‚¹ã‚¯ï¼ˆå°†æ¥ï¼‰**:

- [ ] Transport å®Ÿè£…ï¼ˆgRPC/HTTP ã§ãƒãƒ¼ãƒ‰é–“é€šä¿¡ï¼‰
- [ ] æ°¸ç¶šåŒ–ï¼ˆcurrentTerm, votedFor, log ã‚’ WAL ã«ä¿å­˜ï¼‰
- [ ] ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆ
- [ ] çµ±åˆãƒ†ã‚¹ãƒˆï¼ˆ3ãƒãƒ¼ãƒ‰ã‚¯ãƒ©ã‚¹ã‚¿ï¼‰

---

## Phase 7: åˆ†æ•£ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ âœ… å®Œäº†

- [x] distributed/hlc.go - Hybrid Logical Clock
  - [x] Timestamp æ§‹é€ ä½“
  - [x] Now() - ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—å–å¾—
  - [x] Update() - ãƒãƒ¼ãƒ‰é–“åŒæœŸ
  - [x] Compare() - æ¯”è¼ƒ
- [x] distributed/mvcc.go - Multi-Version Concurrency Control
  - [x] Version / Version Chain
  - [x] Put() - æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³è¿½åŠ 
  - [x] Get() - ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆèª­ã¿å–ã‚Š
  - [x] Delete() - Tombstone
- [x] distributed/two_phase_commit.go - 2ç›¸ã‚³ãƒŸãƒƒãƒˆï¼ˆ2PCï¼‰
  - [x] Coordinator - ã‚³ãƒ¼ãƒ‡ã‚£ãƒãƒ¼ã‚¿ãƒ¼
  - [x] Participant - å‚åŠ è€…ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
  - [x] Prepare / Commit / Abort
- [x] distributed/integration_test.go - çµ±åˆãƒ†ã‚¹ãƒˆ
  - [x] é€é‡‘ã‚·ãƒŠãƒªã‚ª
  - [x] ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆåˆ†é›¢
  - [x] ä¸¦è¡Œãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³

**é”æˆ**: è¤‡æ•°ãƒãƒ¼ãƒ‰ã«ã¾ãŸãŒã‚‹ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ãŒACIDä¿è¨¼ã•ã‚Œã‚‹

---

## Phase 8: ã‚·ãƒ£ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ï¼ˆãƒ‡ãƒ¼ã‚¿åˆ†å‰²ï¼‰âœ… å®Œäº†

- [x] sharding/range.go - ãƒ¬ãƒ³ã‚¸ãƒ™ãƒ¼ã‚¹ã‚·ãƒ£ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°
  - [x] Range æ§‹é€ ä½“ï¼ˆã‚­ãƒ¼ç¯„å›²ï¼‰
  - [x] RangeManagerï¼ˆRange ã®ç®¡ç†ï¼‰
  - [x] FindRangeï¼ˆäºŒåˆ†æ¢ç´¢ï¼‰
  - [x] SplitRangeï¼ˆãƒ¬ãƒ³ã‚¸åˆ†å‰²ï¼‰
  - [x] MergeRangesï¼ˆãƒ¬ãƒ³ã‚¸çµ±åˆï¼‰
- [x] sharding/router.go - ã‚¯ã‚¨ãƒªãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°
  - [x] GetNodeIDByRangeKeyï¼ˆå˜ä¸€ã‚­ãƒ¼ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ï¼‰
  - [x] RouteRangeï¼ˆç¯„å›²ã‚¯ã‚¨ãƒªãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ï¼‰
  - [x] overlapsï¼ˆç¯„å›²é‡ãªã‚Šåˆ¤å®šï¼‰
- [x] sharding/rebalancer.go - ãƒ‡ãƒ¼ã‚¿å†é…ç½®
  - [x] GetNodeRangeCountsï¼ˆãƒãƒ¼ãƒ‰åˆ¥ Range æ•°ï¼‰
  - [x] SuggestRebalanceï¼ˆãƒªãƒãƒ©ãƒ³ã‚¹ææ¡ˆï¼‰
  - [x] ExecuteRebalanceï¼ˆãƒªãƒãƒ©ãƒ³ã‚¹å®Ÿè¡Œï¼‰
- [x] sharding/integration_test.go - çµ±åˆãƒ†ã‚¹ãƒˆ

**é”æˆ**: ãƒ¬ãƒ³ã‚¸ãƒ™ãƒ¼ã‚¹ã‚·ãƒ£ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã®åŸºç›¤ãŒå‹•ã

**æ®‹ã‚¿ã‚¹ã‚¯ï¼ˆå°†æ¥ï¼‰**:

- [ ] å®Ÿãƒ‡ãƒ¼ã‚¿ã®ç§»å‹•ï¼ˆTransport å±¤ãŒå¿…è¦ï¼‰
- [ ] ãƒ›ãƒƒãƒˆã‚¹ãƒãƒƒãƒˆæ¤œå‡ºï¼ˆã‚¢ã‚¯ã‚»ã‚¹é »åº¦ãƒ™ãƒ¼ã‚¹ï¼‰
- [ ] è‡ªå‹•ãƒªãƒãƒ©ãƒ³ã‚¹

---

## Phase 9: åˆ†æ•£ã‚¯ã‚¨ãƒªå®Ÿè¡Œ

- [ ] distributed/planner.go - åˆ†æ•£ã‚¯ã‚¨ãƒªãƒ—ãƒ©ãƒ³ãƒŠãƒ¼
  - [ ] ã‚¯ã‚¨ãƒªã‚’è¤‡æ•°ãƒãƒ¼ãƒ‰ã«åˆ†è§£
  - [ ] Scatter-Gather ãƒ‘ã‚¿ãƒ¼ãƒ³
- [ ] distributed/executor.go - åˆ†æ•£å®Ÿè¡Œã‚¨ãƒ³ã‚¸ãƒ³
  - [ ] ä¸¦åˆ—å®Ÿè¡Œ
  - [ ] çµæœã®ãƒãƒ¼ã‚¸
- [ ] distributed/join.go - åˆ†æ•£JOIN
  - [ ] Broadcast Join
  - [ ] Shuffle Join

**ã‚´ãƒ¼ãƒ«**: è¤‡æ•°ãƒãƒ¼ãƒ‰ã«åˆ†æ•£ã—ãŸãƒ†ãƒ¼ãƒ–ãƒ«åŒå£«ã®JOINãŒå‹•ã

---

## Phase 10: æœ¬ç•ªé‹ç”¨æ©Ÿèƒ½

- [ ] cluster/membership.go - ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¡ãƒ³ãƒãƒ¼ã‚·ãƒƒãƒ—
  - [ ] ãƒãƒ¼ãƒ‰å‚åŠ /é›¢è„±
  - [ ] ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯
- [ ] cluster/metadata.go - ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ç®¡ç†
  - [ ] ãƒ†ãƒ¼ãƒ–ãƒ«å®šç¾©ã®åˆ†æ•£ç®¡ç†
  - [ ] ã‚¹ã‚­ãƒ¼ãƒå¤‰æ›´ã®ä¼æ’­
- [ ] monitoring/metrics.go - ãƒ¡ãƒˆãƒªã‚¯ã‚¹åé›†
  - [ ] Prometheuså½¢å¼
  - [ ] QPS, ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·, ã‚¨ãƒ©ãƒ¼ç‡
- [ ] admin/api.go - ç®¡ç†API
  - [ ] ãƒãƒ¼ãƒ‰è¿½åŠ /å‰Šé™¤
  - [ ] ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—/ãƒªã‚¹ãƒˆã‚¢

**ã‚´ãƒ¼ãƒ«**: æœ¬ç•ªç’°å¢ƒã§é‹ç”¨ã§ãã‚‹åˆ†æ•£DB

---

## ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ï¼ˆæœ€çµ‚å½¢ï¼‰

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   SQL Client    â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   SQL Layer     â”‚  â† Parser, Planner, Executor
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                   â”‚                   â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     Node 1      â”‚ â”‚     Node 2      â”‚ â”‚     Node 3      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Storage  â”‚  â”‚ â”‚  â”‚  Storage  â”‚  â”‚ â”‚  â”‚  Storage  â”‚  â”‚
â”‚  â”‚  Engine   â”‚  â”‚ â”‚  â”‚  Engine   â”‚  â”‚ â”‚  â”‚  Engine   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   Raft    â”‚â—„â”€â”¼â”€â”¼â”€â–ºâ”‚   Raft    â”‚â—„â”€â”¼â”€â”¼â”€â–ºâ”‚   Raft    â”‚  â”‚
â”‚  â”‚ Consensus â”‚  â”‚ â”‚  â”‚ Consensus â”‚  â”‚ â”‚  â”‚ Consensus â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  Range A, C     â”‚ â”‚  Range B, A     â”‚ â”‚  Range C, B     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ç¾åœ¨ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆ

```
minidb/
â”œâ”€â”€ cmd/
â”‚   â””â”€â”€ minidb/
â”‚       â””â”€â”€ main.go
â”œâ”€â”€ internal/
â”‚   â”œâ”€â”€ storage/          # Phase 1 âœ…
â”‚   â”‚   â”œâ”€â”€ page.go
â”‚   â”‚   â”œâ”€â”€ pager.go
â”‚   â”‚   â”œâ”€â”€ page_layout.go
â”‚   â”‚   â”œâ”€â”€ types.go
â”‚   â”‚   â”œâ”€â”€ schema.go
â”‚   â”‚   â”œâ”€â”€ row.go
â”‚   â”‚   â””â”€â”€ table.go
â”‚   â”œâ”€â”€ index/            # Phase 2 âœ…
â”‚   â”‚   â”œâ”€â”€ btree.go
â”‚   â”‚   â””â”€â”€ index.go
â”‚   â”œâ”€â”€ parser/           # Phase 3 âœ…
â”‚   â”‚   â”œâ”€â”€ token.go
â”‚   â”‚   â”œâ”€â”€ lexer.go
â”‚   â”‚   â”œâ”€â”€ ast.go
â”‚   â”‚   â””â”€â”€ parser.go
â”‚   â”œâ”€â”€ executor/         # Phase 5 âœ…
â”‚   â”‚   â”œâ”€â”€ executor.go
â”‚   â”‚   â”œâ”€â”€ iterator.go
â”‚   â”‚   â”œâ”€â”€ result.go
â”‚   â”‚   â””â”€â”€ aggregate.go
â”‚   â”œâ”€â”€ planner/          # Phase 5 âœ…
â”‚   â”‚   â”œâ”€â”€ planner.go
â”‚   â”‚   â”œâ”€â”€ plan_node.go
â”‚   â”‚   â”œâ”€â”€ optimizer.go
â”‚   â”‚   â”œâ”€â”€ rule.go
â”‚   â”‚   â”œâ”€â”€ cost.go
â”‚   â”‚   â””â”€â”€ cost_estimator.go
â”‚   â”œâ”€â”€ dbtxn/            # Phase 4 âš 
â”‚   â”‚   â”œâ”€â”€ wal.go
â”‚   â”‚   â”œâ”€â”€ transaction.go
â”‚   â”‚   â””â”€â”€ recovery.go
â”‚   â”œâ”€â”€ catalog/          # Phase 3 âœ…
â”‚   â”‚   â””â”€â”€ catalog.go
â”‚   â”œâ”€â”€ session/          # Phase 3 âœ…
â”‚   â”‚   â””â”€â”€ session.go
â”‚   â”œâ”€â”€ raft/             # Phase 6 âœ…
â”‚   â”‚   â”œâ”€â”€ state.go
â”‚   â”‚   â”œâ”€â”€ log.go
â”‚   â”‚   â”œâ”€â”€ election.go
â”‚   â”‚   â”œâ”€â”€ replication.go
â”‚   â”‚   â””â”€â”€ heartbeat.go
â”‚   â”œâ”€â”€ replication/       # Phase 6 âœ…
â”‚   â”‚   â””â”€â”€ manager.go
â”‚   â”œâ”€â”€ sharding/         # Phase 8 (æœªå®Ÿè£…)
â”‚   â”œâ”€â”€ distributed/      # Phase 7, 9 (æœªå®Ÿè£…)
â”‚   â”œâ”€â”€ cluster/          # Phase 10 (æœªå®Ÿè£…)
â”‚   â”œâ”€â”€ monitoring/       # Phase 10 (æœªå®Ÿè£…)
â”‚   â””â”€â”€ admin/            # Phase 10 (æœªå®Ÿè£…)
â”œâ”€â”€ pkg/
â”‚   â””â”€â”€ repl/             # Phase 3 âœ…
â”‚       â””â”€â”€ repl.go
â”œâ”€â”€ docs/
â”‚   â”œâ”€â”€ plans/
â”‚   â”‚   â””â”€â”€ database-impliment-plan.md
â”‚   â”œâ”€â”€ reports/
â”‚   â”‚   â””â”€â”€ phase5-query-engine.md
â”‚   â””â”€â”€ agent/
â”œâ”€â”€ go.mod
â””â”€â”€ README.md
```

---

## å‚è€ƒè³‡æ–™

### åŸºç¤ï¼ˆPhase 1-5ï¼‰

- [db_tutorial](https://cstack.github.io/db_tutorial/) - SQLiteã‚¯ãƒ­ãƒ¼ãƒ³ã®ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«
- [bbolt](https://github.com/etcd-io/bbolt) - Goã®B+Tree KVS
- [CMU Database Course](https://15445.courses.cs.cmu.edu/) - DBè¬›ç¾©

### åˆ†æ•£ã‚·ã‚¹ãƒ†ãƒ ï¼ˆPhase 6-10ï¼‰

- [Raftè«–æ–‡](https://raft.github.io/raft.pdf) - ã‚³ãƒ³ã‚»ãƒ³ã‚µã‚¹ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ 
- [etcd/raft](https://github.com/etcd-io/raft) - Goã®Raftå®Ÿè£…
- [TiDB](https://github.com/pingcap/tidb) - MySQLäº’æ›ã®åˆ†æ•£DB
- [CockroachDB](https://github.com/cockroachdb/cockroach) - PostgreSQLäº’æ›ã®åˆ†æ•£DB
- [Spannerè«–æ–‡](https://research.google/pubs/pub39966/) - Googleã®åˆ†æ•£DB
- [Percolatorè«–æ–‡](https://research.google/pubs/pub36726/) - åˆ†æ•£ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³

---

## ãƒã‚¤ãƒ«ã‚¹ãƒˆãƒ¼ãƒ³

| Phase | é”æˆã™ã‚‹ã¨... | çŠ¶æ…‹ |
|-------|-------------|------|
| 1-3   | è‡ªä½œDBã§SQLãŒå‹•ãï¼ | âœ… é”æˆ |
| 4-5   | æœ¬æ ¼çš„ãªRDBMSã«ãªã‚‹ï¼ | âœ… é”æˆ |
| 6     | Raft ã‚³ãƒ³ã‚»ãƒ³ã‚µã‚¹åŸºç›¤ï¼ | âœ… é”æˆ |
| 7     | åˆ†æ•£ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ï¼ | âœ… é”æˆ |
| 8     | ã‚·ãƒ£ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°åŸºç›¤ï¼ | âœ… é”æˆ |
| 9-10  | TiDB/CockroachDBç´šã®åˆ†æ•£DBï¼ | ğŸ”œ æ¬¡ |

---

## æ¬¡ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³

### ã‚ªãƒ—ã‚·ãƒ§ãƒ³ A: Phase 9 ã«é€²ã‚€ï¼ˆåˆ†æ•£ã‚¯ã‚¨ãƒªå®Ÿè¡Œï¼‰

è¤‡æ•°ã‚·ãƒ£ãƒ¼ãƒ‰ã«ã¾ãŸãŒã‚‹ã‚¯ã‚¨ãƒªã®ä¸¦åˆ—å®Ÿè¡Œã‚’å®Ÿè£…ã™ã‚‹ã€‚

### ã‚ªãƒ—ã‚·ãƒ§ãƒ³ B: Transport å®Ÿè£…ï¼ˆPhase 6 æ®‹ã‚¿ã‚¹ã‚¯ï¼‰

gRPC ã§å®Ÿéš›ã®ãƒãƒ¼ãƒ‰é–“é€šä¿¡ã‚’å®Ÿè£…ã—ã€3ãƒãƒ¼ãƒ‰ã‚¯ãƒ©ã‚¹ã‚¿ã§å‹•ä½œç¢ºèªã™ã‚‹ã€‚

### ã‚ªãƒ—ã‚·ãƒ§ãƒ³ C: SQL ãƒ¬ã‚¤ãƒ¤ãƒ¼ã¨ã®çµ±åˆ

Phase 7-8 ã®åˆ†æ•£æ©Ÿèƒ½ã‚’ SQL ãƒ¬ã‚¤ãƒ¤ãƒ¼ï¼ˆSession/Executorï¼‰ã¨çµ±åˆã™ã‚‹ã€‚

### ã‚ªãƒ—ã‚·ãƒ§ãƒ³ D: Phase 2 ã®æ®‹ã‚Šã‚’å®Ÿè£…ï¼ˆB+Tree Deleteï¼‰

B+Tree ã® Delete æ“ä½œã‚’å®Ÿè£…ã—ã¦ã€ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹æ©Ÿèƒ½ã‚’å®Œæˆã•ã›ã‚‹ã€‚
